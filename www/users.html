<div class="container my-2">
    <div id="userListData">
        <h2>
            <b>Users</b>
        </h2>
        <div class="table-div">
            <table id="userTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>Joined</th>
                        <th>Name</th>
                        <th>Phone</th>
                        <th>Info</th>
                        <th>Call Member</th>
                    </tr>
                </thead>
                <tbody id="body-data">
 
                </tbody>
            </table>
        </div>
    </div>

    <div id="showUserInfo" style="display: none;" class="pt-3">
        <!-- <form id="placeForm">
            
        </form> -->
        <div>
            <button onclick="goBack()" class="btn">
                <i class="fa fa-chevron-left"></i> Back
            </button>
        </div>
        <h2 class="text-center">
            <b>User Information</b>
        </h2>
        <form class="px-2">

            <div class="form-group">
                <label for="uname">
                    <b>Name</b>
                </label>
                <input type="text" class="form-control" id="uname" placeholder="Name" readonly>
            </div>

            <div class="form-group">
                <label for="phone">
                    <b>Phone</b>
                </label>
                <input type="text" class="form-control" id="phone" placeholder="Phone" readonly>
            </div>

            <div class="form-group">
                <label for="joined">
                    <b>Joined</b>
                </label>
                <input type="text" class="form-control" id="joined" placeholder="Joined" readonly>
            </div>

            <div class="form-group">
                <label>
                    <b>Questions/Answers</b>
                </label>
                <div id="answerList">

                </div>
            </div>
        </form>
    </div>


      <!-- Add Phone number Modal -->
      <div class="modal fade" id="phoneModal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Enter your phone number and we will connect you</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form class="px-2">
                        <div class="form-group">
                            <label for="phone">Phone</label>
                            <input type="number" class="form-control" id="uname" placeholder="Phone">
                        </div>
                        <button type="button" class="btn btn-primary float-right">Call</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>

    var user_list = [];

    $(document).ready(function () {

        get_user_list(function (users) {

            user_list = users;

            users.forEach((item, i) => {
                $('#body-data').append(`<tr>
                <td>${item.created_at}</td>
                <td>${item.name}</td>
                <td>${item.phone}</td>
                <td><button onclick="info('${i}')" class="btn btn-primary btn-edit"><i class="fa fa-info-circle"></i></button></td>
                <td><button class="btn btn-primary btn-edit" data-toggle="modal" data-target="#phoneModal" type="button"><i class="fa fa-phone-square"></i></button></td>
                </tr>`);
            });

            $('#userTable').DataTable();
        });
    });

    function goBack() {
        $("#userListData").show();
        $("#showUserInfo").hide();
    }

    function info(ind) {
        console.log(user_list[ind]);
        $("#userListData").hide();
        $("#showUserInfo").show();

        $("#uname").val(user_list[ind].name);
        $("#phone").val(user_list[ind].phone);
        $("#joined").val(user_list[ind].created_at);

        $("#answerList").empty();

        var html = "";

        user_list[ind].answers.forEach((item, i) => {
            html += `<div class="form-group">
                        <label>${i + 1}. ${item.question}</label>
                        <input type="text" class="form-control" value="${item.answer}" readonly>
                    </div>`
        });

        $("#answerList").append(html);

    }

</script>